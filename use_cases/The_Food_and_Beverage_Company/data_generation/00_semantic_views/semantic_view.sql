create or replace semantic view AI_DEVELOPMENT.SI_THE_FOOD_AND_BEVERAGE_COMPANY.SALES_MODEL
	tables (
		DIM_CUSTOMERS primary key (CUSTOMER_ID) with synonyms=('CUSTOMERS','CLIENTS','CONSUMERS','PATRONS','CLIENT_BASE','CUSTOMER_BASE') comment='This table stores customer demographic information, including unique identifiers, personal characteristics, and geographic location, to support business analysis and decision-making.',
		DIM_DATES primary key (DATE_KEY) with synonyms=('DIM_DATE','CALENDAR','DATE_DIMENSION','TIME_DIM','CALENDAR_TABLE','DATE_TABLE','TIME_TABLE','CALENDAR_DIM','DATE_DIM','CALENDAR_INFO') comment='This table stores a set of dates and their corresponding attributes, providing a single source of truth for date-related information. It contains a unique identifier for each date, the date itself, and various derived attributes such as year, month, day of the year, week of the year, quarter, and day and month names, enabling efficient querying and analysis of date-based data.',
		DIM_PLATFORMS primary key (PLATFORM_ID) with synonyms=('platforms') comment='This table stores information about various platforms, with each platform uniquely identified by a platform ID. The platform name provides a descriptive label for each platform, allowing for easy identification and reference.',
		DIM_PRODUCTS primary key (PRODUCT_ID) with synonyms=('products','product_list','product_dimension','product_master','product_catalog') comment='This table stores information about products, including their unique identifier, categorization, name, tier, and pricing details, serving as a master reference for product data.',
		DIM_PRODUCT_HIERARCHY primary key (CATEGORY_HIER_1_ID,CATEGORY_HIER_2_ID) with synonyms=('product categories','product classification','product hierarchy table','product levels','category structure','product taxonomy','product categorization','product grouping') comment='This table stores the hierarchical structure of product categories, with each record representing a unique combination of a first-level category and a second-level category, allowing for the tracking and analysis of products within a nested category framework.',
		DIM_SUPPLIERS primary key (SUPPLIER_ID) with synonyms=('vendors','suppliers_list','supplier_table','supplier_info','supplier_data','supplier_details') comment='This table stores information about the suppliers of a company, including their unique identifier, name, location details, and contact person.',
		FACT_DAILY_STOCK_LEVELS with synonyms=('STOCK_LEVELS','DAILY_INVENTORY','PRODUCT_STOCK_STATUS','INVENTORY_LEVELS','STOCK_STATUS_REPORT','DAILY_PROD_STOCK','PRODUCT_AVAILABILITY','STOCK_LEVEL_REPORT') comment='This view provides a daily snapshot of stock levels for each product, including the date, product ID, daily stock change, and available stock. It aggregates supplier ddeliveries and customer transactions to calculate the daily stock change, and then uses a running total to determine the available stock for each product on each date.',
		FACT_SUPPLIER_DELIVERIES with synonyms=('supplier_deliveries','deliveries','supplier_shipments','product_shipments','inventory_deliveries','supply_chain_data') comment='This table stores historical data on deliveries made by suppliers to the company, including the product ID, supplier ID, quantity delivered, and the date of delivery, allowing for tracking and analysis of supplier performance and inventory management.',
		FACT_TRANSACTIONS with synonyms=('transactions','sales','orders','purchases','customer_purchases','product_sales','platform_transactions','daily_transactions') comment='This table stores transactional data for a food and beverage company, capturing key information about each transaction, including the date, customer, product, platform, quantity sold, and session duration, allowing for analysis of sales trends, customer behavior, and platform performance.'
	)
	relationships (
		PRODUCTS_HIERARCHY as DIM_PRODUCTS(CATEGORY_HIER_1_ID,CATEGORY_HIER_2_ID) references DIM_PRODUCT_HIERARCHY(CATEGORY_HIER_1_ID,CATEGORY_HIER_2_ID),
		STOCK_DATES as FACT_DAILY_STOCK_LEVELS(DATE_KEY) references DIM_DATES(DATE_KEY),
		STOCK_PRODUCTS as FACT_DAILY_STOCK_LEVELS(PRODUCT_ID) references DIM_PRODUCTS(PRODUCT_ID),
		SUPPLIER_DATES as FACT_SUPPLIER_DELIVERIES(DATE_KEY) references DIM_DATES(DATE_KEY),
		SUPPLIER_DIMENSIONS as FACT_SUPPLIER_DELIVERIES(SUPPLIER_ID) references DIM_SUPPLIERS(SUPPLIER_ID),
		SUPPLIER_PRODUCTS as FACT_SUPPLIER_DELIVERIES(PRODUCT_ID) references DIM_PRODUCTS(PRODUCT_ID),
		TRANSACTIONS_CUSTOMERS as FACT_TRANSACTIONS(CUSTOMER_ID) references DIM_CUSTOMERS(CUSTOMER_ID),
		TRANSACTIONS_DATES as FACT_TRANSACTIONS(DATE_KEY) references DIM_DATES(DATE_KEY),
		TRANSACTIONS_PLATFORMS as FACT_TRANSACTIONS(PLATFORM_ID) references DIM_PLATFORMS(PLATFORM_ID),
		TRANSACTIONS_PRODUCTS as FACT_TRANSACTIONS(PRODUCT_ID) references DIM_PRODUCTS(PRODUCT_ID)
	)
	facts (
		PUBLIC DIM_PRODUCTS.PRODUCT_UNIT_COGS as PRODUCT_UNIT_COGS with synonyms=('unit_cost','cost_per_unit','product_cost','unit_expense','cost_of_goods_sold','product_expense') comment='The cost of goods sold for a single unit of each product.',
		PUBLIC DIM_PRODUCTS.PRODUCT_UNIT_PRICE as PRODUCT_UNIT_PRICE with synonyms=('unit_price','price_per_unit','item_price','price_per_item') comment='The price of a single unit of a product.',
		PUBLIC FACT_DAILY_STOCK_LEVELS.AVAILABLE_STOCK as AVAILABLE_STOCK with synonyms=('current_stock','stock_balance','stock_level','inventory_level','stock_on_hand','total_stock','stock_quantity') comment='The quantity of a particular stock item that is currently available for sale or use, reflecting the current level of inventory on hand.',
		PUBLIC FACT_DAILY_STOCK_LEVELS.STOCK_CHANGE as STOCK_CHANGE with synonyms=('stock_difference','stock_variation','stock_fluctuation','inventory_change','stock_deviation','stock_shift') comment='The daily change in the stock level, representing the difference between the current day''s stock level and the previous day''s stock level, with a negative value indicating a decrease and a positive value indicating an increase.',
		PUBLIC FACT_SUPPLIER_DELIVERIES.QUANTITY_DELIVERED as QUANTITY_DELIVERED with synonyms=('supplier_amount','quantity_supplied','supplier_volume','delivered_quantity','supplied_units') comment='The quantity of products delivered by a supplier.',
		PUBLIC FACT_TRANSACTIONS.QUANTITY as QUANTITY with synonyms=('amount','count','volume','number','total','units','items','stock','inventory','bulk') comment='The quantity of items involved in a transaction.',
		PUBLIC FACT_TRANSACTIONS.SESSION_DURATION as SESSION_DURATION with synonyms=('session_length','interaction_time','visit_duration','time_spent','engagement_time','active_time') comment='The length of time, in seconds, that a user''s session lasted.'
	)
	dimensions (
		PUBLIC DIM_CUSTOMERS.BIRTHDATE as BIRTHDATE with synonyms=('date_of_birth','birth_date','dob','birthday','date_of_origin') comment='Date of birth of the customer.',
		PUBLIC DIM_CUSTOMERS.COUNTRY as COUNTRY with synonyms=('nation','land','territory','state','region','homeland','nationality','geographic_location','place_of_origin') comment='The country where the customer is located.',
		PUBLIC DIM_CUSTOMERS.CUSTOMER_ID as CUSTOMER_ID with synonyms=('client_id','customer_key','account_number','user_id','client_number','account_id','customer_reference','unique_customer_identifier') comment='Unique identifier for each customer in the database.',
		PUBLIC DIM_CUSTOMERS.GENDER as GENDER with synonyms=('sex','male_female','demographic','biological_sex','person_type') comment='The gender of the customer, either Male or Female.',
		PUBLIC DIM_CUSTOMERS.NAME as NAME with synonyms=('full_name','customer_name','person_name','individual_name','client_name') comment='The name of the customer.',
		PUBLIC DIM_DATES.DATE as DATE with synonyms=('calendar_date','date_value','date_field','calendar_day','date_column','date_key_date','date_attribute') comment='Date dimension representing a specific point in time, used for tracking and analyzing data over a timeline.',
		PUBLIC DIM_DATES.DATE_KEY as DATE_KEY with synonyms=('date_id','date_code','calendar_key','date_identifier','date_number','calendar_id','date_index') comment='Unique identifier for a specific date in the format YYYYMMDD.',
		PUBLIC DIM_DATES.DATE_TRUNCATED_TO_MONTH as DATE_TRUNCATED_TO_MONTH with synonyms=('first_day_of_month','month_start_date','truncated_month','month_trunc','first_day_of_calendar_month','month_beginning_date') comment='The date truncated to the first day of the month, effectively removing the day component and representing the month as a whole.',
		PUBLIC DIM_DATES.DATE_TRUNCATED_TO_WEEK as DATE_TRUNCATED_TO_WEEK with synonyms=('week_start_date','start_of_week','week_beginning','truncated_week','weekly_start_date','week_truncation','beginning_of_week') comment='The date truncated to the first day of the week (Sunday) in which the original date falls.',
		PUBLIC DIM_DATES.DAY_NAME as DAY_NAME with synonyms=('day_of_week','weekday','day_type','day_description','day_label') comment='The full name of the day of the week.',
		PUBLIC DIM_DATES.DAY_OF_YEAR as DAY_OF_YEAR with synonyms=('day_of_calendar','julian_day','day_number','annual_day','yearly_day','day_in_year') comment='The day of the year, ranging from 1 (January 1) to 365 (December 31), representing the sequential day of the year.',
		PUBLIC DIM_DATES.MONTH as MONTH with synonyms=('month_number','month_value','month_code','calendar_month','month_of_year') comment='The month of the year, represented as a numerical value (1-12), where 1 corresponds to January and 12 corresponds to December.',
		PUBLIC DIM_DATES.MONTH_NAME as MONTH_NAME with synonyms=('month_full_name','full_month_name','month_long_name','month_full_description','month_text') comment='The full name of the month, such as January, February, or March, represented by a three-letter abbreviation.',
		PUBLIC DIM_DATES.QUARTER as QUARTER with synonyms=('quarterly_period','financial_quarter','fiscal_quarter','quarterly_term','period_of_year') comment='The quarter of the year, with 1 representing January to March, 2 representing April to June, 3 representing July to September, and 4 (not listed) representing October to December.',
		PUBLIC DIM_DATES.WEEK_OF_YEAR as WEEK_OF_YEAR with synonyms=('week_number','calendar_week','week_of_calendar','yearly_week_number','week_in_year') comment='The week of the year, ranging from 1 to 52 or 53, depending on the year, indicating the week number in which a date falls.',
		PUBLIC DIM_DATES.YEAR as YEAR with synonyms=('calendar_year','fiscal_year','annual_period','yearly_period','twelve_month_period') comment='The calendar year to which a date belongs.',
		PUBLIC DIM_PLATFORMS.PLATFORM_ID as PLATFORM_ID with synonyms=('platform_key','platform_code','platform_identifier','platform_reference','platform_unique_id') comment='Unique identifier for a specific platform, used to distinguish between different platforms in the system.',
		PUBLIC DIM_PLATFORMS.PLATFORM_NAME as PLATFORM_NAME with synonyms=('platform_title','system_name','software_name','application_name','service_name','product_name') comment='The platform through which customers interact with the company, such as social media, video sharing, or the company''s own website.',
		PUBLIC DIM_PRODUCTS.CATEGORY_HIER_1_ID as CATEGORY_HIER_1_ID with synonyms=('top_level_category_id','primary_category_id','category_level_1','first_level_category','high_level_category_id','main_category_id') comment='The top-level category identifier for a product in the hierarchical product categorization structure.',
		PUBLIC DIM_PRODUCTS.CATEGORY_HIER_2_ID as CATEGORY_HIER_2_ID with synonyms=('subcategory_id','category_level_2','secondary_category','subcategory_code','category_hierarchy_2','second_level_category') comment='The second level of the product category hierarchy.',
		PUBLIC DIM_PRODUCTS.PRODUCT_ID as PRODUCT_ID with synonyms=('product_key','product_code','item_id','product_identifier','sku','product_number') comment='Unique identifier for a product in the catalog.',
		PUBLIC DIM_PRODUCTS.PRODUCT_NAME as PRODUCT_NAME with synonyms=('product_title','item_name','product_description','item_description','product_label') comment='The name of the product being sold, which can be used to analyze sales trends and customer preferences by specific product.',
		PUBLIC DIM_PRODUCTS.PRODUCT_TIER as PRODUCT_TIER with synonyms=('product_level','product_category','product_rank','product_grade','product_classification','product_segment') comment='The PRODUCT_TIER dimension categorizes products into three distinct levels of quality and features, where Premium represents high-end products with advanced features, Standard represents mid-range products with standard features, and Budget represents entry-level products with basic features.',
		PUBLIC DIM_PRODUCT_HIERARCHY.CATEGORY_HIER_1_ID as CATEGORY_HIER_1_ID with synonyms=('top_level_category_id','primary_category_id','category_group_id','first_level_category_identifier','high_level_category_code') comment='The top-level category identifier in the product hierarchy, representing the highest level of categorization for a product.',
		PUBLIC DIM_PRODUCT_HIERARCHY.CATEGORY_HIER_1_NAME as CATEGORY_HIER_1_NAME with synonyms=('top_level_category','primary_category','main_category','first_level_category','high_level_category','category_name_level_1','parent_category','category_1_name') comment='The top-level category name for a product in the hierarchy, representing the broadest classification of the product (e.g. Confectionery, Beverages, Food Products).',
		PUBLIC DIM_PRODUCT_HIERARCHY.CATEGORY_HIER_2_ID as CATEGORY_HIER_2_ID with synonyms=('subcategory_id','category_level_2_id','subcategory_key','secondary_category_id','category_level_two_id','subcat_id') comment='The second level of the product category hierarchy, which groups products into sub-categories within the overall product category.',
		PUBLIC DIM_PRODUCT_HIERARCHY.CATEGORY_HIER_2_NAME as CATEGORY_HIER_2_NAME with synonyms=('subcategory_name','subcategory_label','category_level_2_name','secondary_category_name','subcategory_title','second_level_category_name') comment='The second level of categorization for a product in the hierarchy, providing a more specific grouping of products within a category.',
		PUBLIC DIM_SUPPLIERS.CITY as CITY with synonyms=('town','municipality','metropolis','urban_area','location','municipality_name','urban_center','geographical_location') comment='The city where the supplier is located.',
		PUBLIC DIM_SUPPLIERS.CONTACT_PERSON as CONTACT_PERSON with synonyms=('account_manager','sales_representative','point_of_contact','key_contact','main_contact','supplier_representative','liaison_person') comment='The name of the person who serves as the primary point of contact for the supplier organization.',
		PUBLIC DIM_SUPPLIERS.COUNTRY as COUNTRY with synonyms=('nation','land','territory','state','region','geographical_area','homeland','nationality') comment='The country where the supplier is located.',
		PUBLIC DIM_SUPPLIERS.STREET as STREET with synonyms=('address','road','avenue','route','way','thoroughfare','residence','building_location') comment='Street address of the supplier''s location.',
		PUBLIC DIM_SUPPLIERS.SUPPLIER_ID as SUPPLIER_ID with synonyms=('supplier_key','vendor_id','provider_id','supplier_code','supplier_number','vendor_key') comment='Unique identifier for a supplier in the system.',
		PUBLIC DIM_SUPPLIERS.SUPPLIER_NAME as SUPPLIER_NAME with synonyms=('supplier_title','vendor_name','provider_name','company_name','organization_name','business_name') comment='The name of the supplier company.',
		PUBLIC FACT_DAILY_STOCK_LEVELS.DATE_KEY as DATE_KEY with synonyms=('date_id','date_code','calendar_date','date_dimension','time_key','calendar_key','date_reference') comment='Date key representing the date for which the stock level is recorded, in the format YYYYMMDD.',
		PUBLIC FACT_DAILY_STOCK_LEVELS.PRODUCT_ID as PRODUCT_ID with synonyms=('product_code','item_id','product_number','item_code','article_id') comment='Unique identifier for a product in the inventory.',
		PUBLIC FACT_SUPPLIER_DELIVERIES.DATE_KEY as DATE_KEY with synonyms=('date_id','date_code','calendar_key','date_reference','calendar_date_id','date_identifier') comment='Date when the delivery was made, represented as an integer in the format YYYYMMDD.',
		PUBLIC FACT_SUPPLIER_DELIVERIES.PRODUCT_ID as PRODUCT_ID with synonyms=('product_code','item_id','product_number','item_code','article_number','product_key') comment='Unique identifier for the product being delivered.',
		PUBLIC FACT_SUPPLIER_DELIVERIES.SUPPLIER_ID as SUPPLIER_ID with synonyms=('provider_id','vendor_id','supplier_code','provider_code','vendor_code','source_id') comment='Unique identifier for the supplier who made the delivery.',
		PUBLIC FACT_TRANSACTIONS.CUSTOMER_ID as CUSTOMER_ID with synonyms=('client_id','customer_key','account_id','user_id','patron_id','buyer_id','client_key','account_number') comment='Unique identifier for the customer who made the transaction.',
		PUBLIC FACT_TRANSACTIONS.DATE_KEY as DATE_KEY with synonyms=('date_id','date_code','calendar_key','date_reference','time_key','calendar_id') comment='Date on which the transaction occurred, represented as an integer in the format YYYYMMDD.',
		PUBLIC FACT_TRANSACTIONS.PLATFORM_ID as PLATFORM_ID with synonyms=('channel_id','site_id','medium_id','source_id','distribution_channel') comment='Unique identifier for the platform where the transaction took place.',
		PUBLIC FACT_TRANSACTIONS.PRODUCT_ID as PRODUCT_ID with synonyms=('item_id','product_code','item_code','product_number','sku','product_key') comment='Unique identifier for the product being transacted.'
	)
	metrics (
		PUBLIC FACT_DAILY_STOCK_LEVELS.TOTAL_STOCK as SUM(AVAILABLE_STOCK) with synonyms=('total_inventory','overall_stock','stock_level','total_quantity','inventory_level','stock_total','total_amount_in_stock') comment='The total quantity of stock on hand for a particular item or product at the end of each day.',
		PUBLIC FACT_SUPPLIER_DELIVERIES.TOTAL_QUANTITY_DELIVERED as SUM(QUANTITY_DELIVERED) with synonyms=('delivery_quantity') comment='Total quantity of all delivered products',
		PUBLIC FACT_TRANSACTIONS.REVENUE as SUM(FACT_TRANSACTIONS.QUANTITY * DIM_PRODUCTS. PRODUCT_UNIT_PRICE) with synonyms=('sales','turnover','income','earnings','profit','proceeds','receipts','gain','revenue') comment='The total amount of money earned from sales or services provided, representing the income generated by the business.'
	)
	with extension (CA='{"tables":[{"name":"DIM_CUSTOMERS","dimensions":[{"name":"COUNTRY","cortex_search_service":{"database":"AI_DEVELOPMENT","schema":"SI_THE_FOOD_AND_BEVERAGE_COMPANY","service":"_LITERAL_SEARCH_CUSTOMER_COUNTRY"}},{"name":"CUSTOMER_ID","sample_values":["CID_00091","CID_00243","CID_00019"]},{"name":"GENDER","sample_values":["Male","Female"],"is_enum":true},{"name":"NAME","cortex_search_service":{"database":"AI_DEVELOPMENT","schema":"SI_THE_FOOD_AND_BEVERAGE_COMPANY","service":"_LITERAL_SEARCH_CUSTOMER_NAME"}}],"time_dimensions":[{"name":"BIRTHDATE","sample_values":["1979-03-29","1978-05-09","1981-10-03"]}]},{"name":"DIM_DATES","dimensions":[{"name":"DATE_KEY","sample_values":["20240227","20240606","20240730"]},{"name":"DAY_NAME","sample_values":["Tue","Mon","Wed"]},{"name":"DAY_OF_YEAR","sample_values":["98","29","1"]},{"name":"MONTH","sample_values":["1","2","3"]},{"name":"MONTH_NAME","sample_values":["Jan","Mar","Feb"]},{"name":"QUARTER","sample_values":["1","2","3"]},{"name":"WEEK_OF_YEAR","sample_values":["29","1","2"]},{"name":"YEAR","sample_values":["2024","2025"]},{"name":"DATE_TRUNCATED_TO_WEEK"},{"name":"DATE_TRUNCATED_TO_MONTH"}],"time_dimensions":[{"name":"DATE","sample_values":["2024-01-12","2024-01-01","2024-04-18"]}]},{"name":"DIM_PLATFORMS","dimensions":[{"name":"PLATFORM_ID","sample_values":["PLATFORM_003","PLATFORM_002","PLATFORM_001"]},{"name":"PLATFORM_NAME","sample_values":["Instagram","YouTube","Website","Facebook","TikTok"],"is_enum":true}]},{"name":"DIM_PRODUCTS","dimensions":[{"name":"CATEGORY_HIER_1_ID","sample_values":["HIER_1","HIER_2","HIER_3"]},{"name":"CATEGORY_HIER_2_ID","sample_values":["HIER_1_1","HIER_5_1","HIER_2_1"]},{"name":"PRODUCT_ID","sample_values":["PID_00000033","PID_00000000","PID_00000001"]},{"name":"PRODUCT_NAME","sample_values":["Senior Dog Wellness Blend","Reserve French Roast Whole Bean","Gourmet Espresso Capsules Gold"],"cortex_search_service":{"database":"AI_DEVELOPMENT","schema":"SI_THE_FOOD_AND_BEVERAGE_COMPANY","service":"_LITERAL_SEARCH_PRODUCT_NAME"}},{"name":"PRODUCT_TIER","sample_values":["Premium","Standard","Budget"],"is_enum":true}],"facts":[{"name":"PRODUCT_UNIT_COGS","sample_values":["8.5","3.1","5.2"]},{"name":"PRODUCT_UNIT_PRICE","sample_values":["8.99","15.99","5.99"]}]},{"name":"DIM_PRODUCT_HIERARCHY","dimensions":[{"name":"CATEGORY_HIER_1_ID","sample_values":["HIER_1","HIER_2","HIER_3"]},{"name":"CATEGORY_HIER_1_NAME","sample_values":["Beverages","Confectionery","Food Products","Health & Nutrition","Pet Care"],"cortex_search_service":{"database":"AI_DEVELOPMENT","schema":"SI_THE_FOOD_AND_BEVERAGE_COMPANY","service":"_LITERAL_SEARCH_PRODUCT_HIERARCHY_1"}},{"name":"CATEGORY_HIER_2_ID","sample_values":["HIER_1_1","HIER_5_1","HIER_2_1"]},{"name":"CATEGORY_HIER_2_NAME","sample_values":["Nutritional supplements","Baby Food","Water","Chocolate bars","Cooking aids","Dairy","Medical nutrition products","Frozen and chilled foods","Pet food and treats","Premium Chocolate","Coffee","Breakfast cereals and bars","Performance nutrition"],"cortex_search_service":{"database":"AI_DEVELOPMENT","schema":"SI_THE_FOOD_AND_BEVERAGE_COMPANY","service":"_LITERAL_SEARCH_PRODUCT_HIERARCHY_2"}}]},{"name":"DIM_SUPPLIERS","dimensions":[{"name":"CITY","sample_values":["Munich","Lyon","London"]},{"name":"CONTACT_PERSON","sample_values":["Margaret Thompson","Klaus Mueller","Giuseppe Rossi"]},{"name":"COUNTRY","sample_values":["Germany","France","United Kingdom"]},{"name":"STREET","sample_values":["Maximilianstrasse 12","Baker Street 221B","Via Torino 45"]},{"name":"SUPPLIER_ID","sample_values":["SUP_ID_00001","SUP_ID_00002","SUP_ID_00000"]},{"name":"SUPPLIER_NAME","sample_values":["Premium Confectionery Ltd","Premium Coffee Roasters Co","Natural Springs Co"]}]},{"name":"FACT_DAILY_STOCK_LEVELS","dimensions":[{"name":"DATE_KEY","sample_values":["20240509","20240905","20250126"]},{"name":"PRODUCT_ID","sample_values":["PID_00000008","PID_00000107","PID_00000071"]}],"facts":[{"name":"AVAILABLE_STOCK","sample_values":["75","269","55"]},{"name":"STOCK_CHANGE","sample_values":["-33","128","-34"]}],"metrics":[{"name":"TOTAL_STOCK"}]},{"name":"FACT_SUPPLIER_DELIVERIES","dimensions":[{"name":"DATE_KEY","sample_values":["20250224","20250623","20250728"]},{"name":"PRODUCT_ID","sample_values":["PID_00000113","PID_00000057","PID_00000118"]},{"name":"SUPPLIER_ID","sample_values":["SUP_ID_00011","SUP_ID_00000","SUP_ID_00004"]}],"facts":[{"name":"QUANTITY_DELIVERED","sample_values":["20","30","10"]}],"metrics":[{"name":"TOTAL_QUANTITY_DELIVERED"}]},{"name":"FACT_TRANSACTIONS","dimensions":[{"name":"CUSTOMER_ID","sample_values":["CID_00058","CID_04188","CID_03715"]},{"name":"DATE_KEY","sample_values":["20240101","20240103","20240102"]},{"name":"PLATFORM_ID","sample_values":["PLATFORM_004","PLATFORM_002","PLATFORM_001"]},{"name":"PRODUCT_ID","sample_values":["PID_00000000","PID_00000001","PID_00000017"]}],"facts":[{"name":"QUANTITY","sample_values":["4","2","1"]},{"name":"SESSION_DURATION","sample_values":["250","247","258"]}],"metrics":[{"name":"REVENUE"}]}],"relationships":[{"name":"PRODUCTS_HIERARCHY"},{"name":"STOCK_DATES"},{"name":"STOCK_PRODUCTS"},{"name":"SUPPLIER_DATES"},{"name":"SUPPLIER_DIMENSIONS"},{"name":"SUPPLIER_PRODUCTS"},{"name":"TRANSACTIONS_CUSTOMERS"},{"name":"TRANSACTIONS_DATES"},{"name":"TRANSACTIONS_PLATFORMS"},{"name":"TRANSACTIONS_PRODUCTS"}],"verified_queries":[{"name":"What was the weekly sales revenue for breakfast products?","question":"What was the weekly sales revenue for breakfast products?","sql":"WITH weekly_revenue AS (\\n  SELECT\\n    dd.date_truncated_to_week AS week_start,\\n    MIN(dd.date) AS start_date,\\n    MAX(dd.date) AS end_date,\\n    SUM(ft.quantity * dp.product_unit_price) AS weekly_revenue\\n  FROM\\n    fact_transactions AS ft\\n    LEFT OUTER JOIN dim_dates AS dd ON ft.date_key = dd.date_key\\n    LEFT OUTER JOIN dim_products AS dp ON ft.product_id = dp.product_id\\n    LEFT OUTER JOIN dim_product_hierarchy AS dph ON dp.category_hier_1_id = dph.category_hier_1_id\\n    AND dp.category_hier_2_id = dph.category_hier_2_id\\n  WHERE\\n    dph.category_hier_2_name = ''Breakfast cereals and bars''\\n  GROUP BY\\n    dd.date_truncated_to_week\\n)\\nSELECT\\n  week_start,\\n  MIN(start_date) AS period_start_date,\\n  MAX(end_date) AS period_end_date,\\n  weekly_revenue\\nFROM\\n  weekly_revenue\\nGROUP BY\\n  week_start,\\n  weekly_revenue\\nORDER BY\\n  week_start DESC NULLS LAST","use_as_onboarding_question":false,"verified_by":"Michael Gorkow","verified_at":1755070099},{"name":"What was the total quantity sold of beverages, their stock levels and quantity of supplier deliveries in Q1 2025 per calendar week?","question":"What was the total quantity sold of beverages, their stock levels and quantity of supplier deliveries in Q1 2025 per calendar week?","sql":"WITH weekly_sales AS (\\n  SELECT\\n    d.date_truncated_to_week AS week,\\n    SUM(ft.quantity) AS total_quantity_sold\\n  FROM\\n    fact_transactions AS ft\\n    LEFT OUTER JOIN dim_dates AS d ON ft.date_key = d.date_key\\n    LEFT OUTER JOIN dim_products AS dp ON ft.product_id = dp.product_id\\n    LEFT OUTER JOIN dim_product_hierarchy AS dph ON dp.category_hier_1_id = dph.category_hier_1_id\\n    AND dp.category_hier_2_id = dph.category_hier_2_id\\n  WHERE\\n    d.year = 2025\\n    AND d.quarter = 1\\n    AND dph.category_hier_1_name = ''Beverages''\\n  GROUP BY\\n    d.date_truncated_to_week\\n),\\nweekly_stock AS (\\n  SELECT\\n    d.date_truncated_to_week AS week,\\n    SUM(fdsl.available_stock) AS total_stock_level\\n  FROM\\n    fact_daily_stock_levels AS fdsl\\n    LEFT OUTER JOIN dim_dates AS d ON fdsl.date_key = d.date_key\\n    LEFT OUTER JOIN dim_products AS dp ON fdsl.product_id = dp.product_id\\n    LEFT OUTER JOIN dim_product_hierarchy AS dph ON dp.category_hier_1_id = dph.category_hier_1_id\\n    AND dp.category_hier_2_id = dph.category_hier_2_id\\n  WHERE\\n    d.year = 2025\\n    AND d.quarter = 1\\n    AND dph.category_hier_1_name = ''Beverages''\\n  GROUP BY\\n    d.date_truncated_to_week\\n),\\nweekly_deliveries AS (\\n  SELECT\\n    d.date_truncated_to_week AS week,\\n    SUM(fsd.quantity_delivered) AS total_quantity_delivered\\n  FROM\\n    fact_supplier_deliveries AS fsd\\n    LEFT OUTER JOIN dim_dates AS d ON fsd.date_key = d.date_key\\n    LEFT OUTER JOIN dim_products AS dp ON fsd.product_id = dp.product_id\\n    LEFT OUTER JOIN dim_product_hierarchy AS dph ON dp.category_hier_1_id = dph.category_hier_1_id\\n    AND dp.category_hier_2_id = dph.category_hier_2_id\\n  WHERE\\n    d.year = 2025\\n    AND d.quarter = 1\\n    AND dph.category_hier_1_name = ''Beverages''\\n  GROUP BY\\n    d.date_truncated_to_week\\n)\\nSELECT\\n  COALESCE(ws.week, wst.week, wd.week) AS week,\\n  COALESCE(ws.total_quantity_sold, 0) AS total_quantity_sold,\\n  COALESCE(wst.total_stock_level, 0) AS total_stock_level,\\n  COALESCE(wd.total_quantity_delivered, 0) AS total_quantity_delivered\\nFROM\\n  weekly_sales AS ws FULL\\n  OUTER JOIN weekly_stock AS wst ON ws.week = wst.week FULL\\n  OUTER JOIN weekly_deliveries AS wd ON COALESCE(ws.week, wst.week) = wd.week\\nORDER BY\\n  ws.week DESC NULLS LAST","use_as_onboarding_question":false,"verified_by":"Michael Gorkow","verified_at":1755070951}]}');